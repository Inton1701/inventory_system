{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { ref, onMounted, onBeforeUnmount, nextTick, watch } from 'vue';\nimport { useRoute } from 'vue-router';\nimport axios from 'axios';\nimport 'select2';\nimport feather from 'feather-icons';\nimport Navbar from '/src/components/Admin/Navbar.vue';\nimport Barcode from './Barcode.vue';\nimport $ from 'jquery';\nexport default {\n  components: {\n    Navbar,\n    Barcode\n  },\n  setup() {\n    const apiURL = process.env.VUE_APP_URL;\n    const imageURL = process.env.VUE_APP_IMAGE_URL;\n    const inputedProduct = ref({\n      sku: '',\n      name: '',\n      description: '',\n      price: 0,\n      cost: 0,\n      category: '',\n      subCategory: '',\n      unit: '',\n      brand: '',\n      variant: '',\n      discount: 0,\n      discountType: '',\n      manufacturedDate: '',\n      expiryDate: '',\n      status: '',\n      image: {\n        file: null,\n        url: null\n      },\n      url: ''\n    });\n    const skuError = ref(null);\n    const route = useRoute();\n    const product = ref({});\n    const barcodeRef = ref(null);\n    const curreSKU = ref(null);\n    const categories = ref(null);\n    const units = ref(null);\n    const brands = ref(null);\n    const getSelection = async () => {\n      try {\n        const categoryResponse = await axios.get(`${apiURL}/get_category_list`);\n        const unitResponse = await axios.get(`${apiURL}/get_units_list`);\n        const brandResponse = await axios.get(`${apiURL}/brands_list`);\n        if (categoryResponse.data.success) {\n          categories.value = categoryResponse.data.categories;\n        } else {\n          Swal.fire('Error', categoryResponse.data.message, 'error');\n        }\n        if (unitResponse.data.success) {\n          units.value = unitResponse.data.unitList;\n        } else {\n          Swal.fire('Error', unitResponse.data.message, 'error');\n        }\n        if (brandResponse.data.success) {\n          brands.value = brandResponse.data.brandList;\n        } else {\n          Swal.fire('Error', brandResponse.data.message, 'error');\n        }\n      } catch (error) {\n        Swal.fire('Error', 'Failed to fetch selection data', 'error');\n      }\n    };\n    const triggerDownloadBarcode = () => {\n      if (barcodeRef.value) {\n        barcodeRef.value.downloadBarcode(); // Access the method on the Barcode component\n      }\n    };\n    const getProductDetails = async () => {\n      const productId = route.params.id; // Use 'id' to match route param\n      try {\n        const response = await axios.get(`${apiURL}/get_product/${productId}`);\n        product.value = response.data.product;\n        curreSKU.value = response.data.product.sku; // Store current SKU for comparison\n        skuError.value = '';\n        inputedProduct.value.url = `${imgUrl}`;\n      } catch (error) {\n        console.error('Error fetching product details:', error);\n      }\n    };\n    watch(product, newProduct => {\n      if (newProduct) {\n        inputedProduct.value = {\n          ...newProduct,\n          image: {\n            file: null,\n            // No file since itâ€™s from the server\n            url: newProduct.imageUrl || null // Map `imageUrl` to `url`\n          },\n          url: newProduct.imageUrl || null // Maintain direct URL reference\n        };\n      }\n    });\n    const select = ref('.select');\n    onMounted(async () => {\n      try {\n        await getProductDetails();\n        await $(select.value).select2();\n        await feather.replace();\n      } catch (error) {\n        console.log(error);\n      }\n    });\n    onBeforeUnmount(() => {\n      $(select.value).select2('destroy');\n    });\n    const toggleStatus = event => {\n      inputedProduct.value.status = event.target.checked ? 'active' : 'inactive';\n    };\n    const autoGenerateSKU = () => {\n      inputedProduct.value.sku = generateEAN13();\n    };\n    const generateEAN13 = () => {\n      let digits = '4';\n      for (let i = 0; i < 11; i++) {\n        digits += Math.floor(Math.random() * 10).toString();\n      }\n      let sumOdd = 0;\n      let sumEven = 0;\n      for (let i = 0; i < 12; i++) {\n        const digit = parseInt(digits[i], 10);\n        if (i % 2 === 0) {\n          sumOdd += digit;\n        } else {\n          sumEven += digit;\n        }\n      }\n      const totalSum = sumOdd + sumEven * 3;\n      const checksum = (10 - totalSum % 10) % 10;\n      return digits + checksum;\n    };\n    watch(() => inputedProduct.value.sku, async newSku => {\n      if (newSku.length === 13) {\n        try {\n          const response = await axios.get(`${this.apiURL}/check_sku/${newSku}`);\n          console.log(response.data.exists);\n          if (response.data.exists) {\n            if (newSku !== curreSKU.value) {\n              // Compare with the previous SKU\n\n              skuError.value = 'SKU already exists'; // Set error message\n              inputedProduct.value.sku = '';\n            }\n          } else {\n            skuError.value = ''; // Clear any existing error if SKU is uniqueF\n          }\n        } catch (error) {\n          console.error('Error checking SKU:', error);\n          if (error.response) {\n            skuError.value = `${error.response.data.message}`; // Backend error message\n          }\n        }\n      }\n    });\n    const editProduct = async () => {\n      try {\n        const formData = new FormData();\n\n        // Append all fields except the image\n        Object.entries(inputedProduct.value).forEach(([key, value]) => {\n          if (key !== 'image') {\n            formData.append(key, value || '');\n          }\n        });\n\n        // Append the image file if uploaded\n        if (inputedProduct.value.image.file) {\n          formData.append('image', inputedProduct.value.image.file);\n        } else if (!inputedProduct.value.url) {\n          // Add a flag to remove the image if it was deleted\n          formData.append('removeImage', true);\n        }\n        const productId = route.params.id;\n        const response = await axios.patch(`${apiURL}/edit_products/${productId}`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        if (response.data.success) {\n          Swal.fire('Success', 'Product updated successfully!', 'success');\n          await getProductDetails(); // Refresh product details\n        } else {\n          Swal.fire('Error', response.data.message || 'Failed to update product', 'error');\n        }\n      } catch (error) {\n        console.error('Error updating product:', error);\n        Swal.fire('Error', 'An error occurred while updating the product', 'error');\n      }\n    };\n    const onFileChange = event => {\n      const file = event.target.files[0];\n      if (file) {\n        inputedProduct.value.image = {\n          file: file,\n          url: URL.createObjectURL(file) // Create a local preview URL\n        };\n        inputedProduct.value.url = null; // Clear the server URL if a new image is uploaded\n      }\n    };\n    const removeImage = () => {\n      // Release uploaded image URL\n      if (inputedProduct.value.image.url) {\n        URL.revokeObjectURL(inputedProduct.value.image.url);\n      }\n\n      // Clear image properties\n      inputedProduct.value.image = {\n        file: null,\n        url: null\n      };\n      inputedProduct.value.url = null; // Clear server-provided image reference\n    };\n    return {\n      inputedProduct,\n      select,\n      editProduct,\n      autoGenerateSKU,\n      toggleStatus,\n      onFileChange,\n      removeImage,\n      triggerDownloadBarcode,\n      skuError,\n      curreSKU,\n      imageURL,\n      apiURL,\n      getSelection,\n      categories,\n      units,\n      brands\n    };\n  },\n  methods: {\n    filterTextInput(value) {\n      return value.replace(/\\D/g, '');\n    },\n    filterNumInput(value) {\n      return value.replace(/[^0-9.]/g, '');\n    }\n  }\n};","map":{"version":3,"names":["ref","onMounted","onBeforeUnmount","nextTick","watch","useRoute","axios","feather","Navbar","Barcode","$","components","setup","apiURL","process","env","VUE_APP_URL","imageURL","VUE_APP_IMAGE_URL","inputedProduct","sku","name","description","price","cost","category","subCategory","unit","brand","variant","discount","discountType","manufacturedDate","expiryDate","status","image","file","url","skuError","route","product","barcodeRef","curreSKU","categories","units","brands","getSelection","categoryResponse","get","unitResponse","brandResponse","data","success","value","Swal","fire","message","unitList","brandList","error","triggerDownloadBarcode","downloadBarcode","getProductDetails","productId","params","id","response","imgUrl","console","newProduct","imageUrl","select","select2","replace","log","toggleStatus","event","target","checked","autoGenerateSKU","generateEAN13","digits","i","Math","floor","random","toString","sumOdd","sumEven","digit","parseInt","totalSum","checksum","newSku","length","exists","editProduct","formData","FormData","Object","entries","forEach","key","append","patch","headers","onFileChange","files","URL","createObjectURL","removeImage","revokeObjectURL","methods","filterTextInput","filterNumInput"],"sources":["C:\\Users\\Administrator\\OneDrive\\Desktop\\POSExpress\\frontend\\src\\components\\Admin\\Inventory\\EditProduct.vue"],"sourcesContent":["<template>\r\n    <Navbar />\r\n\r\n    <div class=\"page-wrapper\">\r\n        <div class=\"content\">\r\n            <div class=\"page-header\">\r\n                <div class=\"add-item d-flex\">\r\n                    <div class=\"page-title\">\r\n                        <h4>New Product</h4>\r\n                        <h6>Create new product</h6>\r\n                    </div>\r\n                </div>\r\n                <ul class=\"table-top-head\">\r\n                    <li>\r\n                        <div class=\"page-btn\">\r\n                            <router-link to=\"products\" class=\"btn btn-secondary\"><i data-feather=\"arrow-left\"\r\n                                    class=\"me-2\"></i>Back to Product</router-link>\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <a data-bs-toggle=\"tooltip\" data-bs-placement=\"top\" title=\"Collapse\" id=\"collapse-header\"><i\r\n                                data-feather=\"chevron-up\" class=\"feather-chevron-up\"></i></a>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"row justify-content-center\">\r\n                <div class=\"col-lg-4 col-md-6 col-sm-8 col-12\">\r\n                    <div class=\"mb-3 add-product text-center\">\r\n                        <!-- Show/hide barcode and error messages -->\r\n                        <div v-show=\"inputedProduct.sku.length === 13 || inputedProduct.sku.length === 0\">\r\n                            <!-- Error Message for invalid SKU -->\r\n                            <div v-if=\"inputedProduct.sku.length !== 13 && inputedProduct.sku.length > 0\"\r\n                                class=\"text-danger\">\r\n                                SKU must be exactly 13 digits.\r\n                            </div>\r\n\r\n                            <!-- Barcode rendering -->\r\n                            <Barcode v-if=\"inputedProduct.sku.length === 13\" ref=\"barcodeRef\" :sku=\"inputedProduct.sku\"\r\n                                :productName=\"inputedProduct.name\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <form @submit.prevent=\"editProduct\">\r\n                <div class=\"card\">\r\n                    <div class=\"card-body add-product pb-0\">\r\n                        <div class=\"accordion-card-one accordion\" id=\"accordionExample\">\r\n                            <div class=\"accordion-item\">\r\n                                <div class=\"accordion-header\" id=\"headingOne\">\r\n                                    <div class=\"accordion-button\" data-bs-toggle=\"collapse\"\r\n                                        data-bs-target=\"#collapseOne\" aria-controls=\"collapseOne\">\r\n                                        <div class=\"addproduct-icon\">\r\n                                            <h5>\r\n                                                <i data-feather=\"info\" class=\"add-info\"></i><span>Product\r\n                                                    Information</span>\r\n                                            </h5>\r\n                                            <a href=\"javascript:void(0);\"><i data-feather=\"chevron-down\"\r\n                                                    class=\"chevron-down-add\"></i></a>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div id=\"collapseOne\" class=\"accordion-collapse collapse show\"\r\n                                    aria-labelledby=\"headingOne\" data-bs-parent=\"#accordionExample\">\r\n                                    <div class=\"accordion-body\">\r\n\r\n\r\n                                        <div class=\"row\">\r\n                                            <div class=\"col-lg-5 col-sm-6 col-12\">\r\n                                                <div class=\"mb-3 add-product\">\r\n                                                    <label class=\"form-label\">Status</label>\r\n                                                    <div\r\n                                                        class=\"status-toggle modal-status d-flex justify-content-between\">\r\n                                                        <span class=\"form-label\">{{ inputedProduct.status }}</span>\r\n                                                        <input type=\"checkbox\" id=\"user4\" class=\"check\"\r\n                                                            :checked=\"inputedProduct.status === 'active'\"\r\n                                                            @change=\"toggleStatus\" />\r\n                                                        <label for=\"user4\" class=\"checktoggle\"></label>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"row\">\r\n                                            <div class=\"col-lg-5 col-sm-6 col-12\">\r\n                                                <div class=\"input-blocks add-product list\">\r\n                                                    <label data-bs-toggle=\"tooltip\"\r\n                                                        title=\"Note: it must be 13 numbers\">SKU\r\n                                                        <i class=\"mb-1\" data-feather=\"help-circle\"\r\n                                                            style=\"height: 15px\"></i>\r\n                                                    </label>\r\n                                                    <input type=\"text\" id=\"sku\" class=\"form-control list\"\r\n                                                        placeholder=\"Enter SKU manually\" :maxlength=\"13\"\r\n                                                        v-model=\"inputedProduct.sku\"\r\n                                                        @input=\"inputedProduct.sku = filterNumInput($event.target.value)\"\r\n                                                        :class=\"{ 'is-invalid': inputedProduct.sku.length !== 13 && inputedProduct.sku.length > 0 }\"\r\n                                                        required />\r\n                                                    <p class=\"mt-1 text-danger\">{{ skuError }}</p>\r\n                                                    <div class=\"d-flex align-items-center mt-2\">\r\n                                                        <button type=\"button\" class=\"btn btn-primaryadd\"\r\n                                                            @click=\"autoGenerateSKU\">Auto Generate</button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"col-lg-5 col-sm-6 col-12\">\r\n                                                <div class=\"mb-3 add-product\">\r\n                                                    <label class=\"form-label\">Product Name</label>\r\n                                                    <input type=\"text\" class=\"form-control\"\r\n                                                        placeholder=\"Product name here.\" :maxlength=\"35\"\r\n                                                        v-model=\"inputedProduct.name\"\r\n                                                        @input=\"productName = filterTextInput($event.target.value)\"\r\n                                                        required />\r\n                                                    <p class=\"mt-1\">Maximum of 35 Characters</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"addservice-info\">\r\n                                            <div class=\"row\">\r\n                                                <div class=\"col-lg-4 col-sm-6 col-12\">\r\n                                                    <div class=\"mb-3 add-product\">\r\n                                                        <div class=\"add-newplus\">\r\n                                                            <label class=\"form-label\">Category</label>\r\n                                                            <a href=\"javascript:void(0);\" data-bs-toggle=\"modal\"\r\n                                                                data-bs-target=\"#add-units-category\"><i\r\n                                                                    data-feather=\"plus-circle\"\r\n                                                                    class=\"plus-down-add\"></i><span>Add New</span></a>\r\n                                                        </div>\r\n                                                        <select class=\"form-control\" v-model=\"inputedProduct.category\">\r\n                                                            <option value=\"None\">None</option>\r\n                                                            <option v-for=\"category in categories\" :key=\"category._id\"\r\n                                                                :value=\"category.name\">\r\n                                                                {{ category.name }}\r\n                                                            </option>\r\n                                                        </select>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div class=\"col-lg-4 col-sm-6 col-12\">\r\n                                                    <div class=\"mb-3 add-product\">\r\n                                                        <div class=\"add-newplus\">\r\n                                                            <label class=\"form-label\">Unit</label>\r\n                                                            <a href=\"javascript:void(0);\" data-bs-toggle=\"modal\"\r\n                                                                data-bs-target=\"#add-unit\"><i data-feather=\"plus-circle\"\r\n                                                                    class=\"plus-down-add\"></i><span>Add New</span></a>\r\n                                                        </div>\r\n                                                        <select class=\"form-control\" v-model=\"inputedProduct.unit\">\r\n                                                            <option selected value=\"None\">None</option>\r\n                                                            <option v-for=\"unit in units\" :key=\"unit._id\"\r\n                                                                :value=\"unit.name\">\r\n                                                                {{ unit.name }}\r\n                                                            </option>\r\n                                                        </select>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div class=\"col-lg-4 col-sm-6 col-12\">\r\n                                                    <div class=\"mb-3 add-product\">\r\n                                                        <div class=\"add-newplus\">\r\n                                                            <label class=\"form-label\">Brand</label>\r\n                                                            <a href=\"javascript:void(0);\" data-bs-toggle=\"modal\"\r\n                                                                data-bs-target=\"#add-units-brand\"><i\r\n                                                                    data-feather=\"plus-circle\"\r\n                                                                    class=\"plus-down-add\"></i><span>Add New</span></a>\r\n                                                        </div>\r\n                                                        <div>\r\n                                                            <select class=\"form-control\" v-model=\"inputedProduct.brand\">\r\n                                                                <option v-for=\"brand in brands\" :key=\"brand._id\"\r\n                                                                    :value=\"brand.name\">\r\n                                                                    {{ brand.name }}\r\n                                                                </option>\r\n                                                            </select>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"col-lg-12\">\r\n                                            <div class=\"input-blocks summer-description-box transfer mb-3\">\r\n                                                <label>Description</label>\r\n                                                <textarea class=\"form-control h-100\" rows=\"5\"\r\n                                                    placeholder=\"Please type here the description\" :maxlength=\"150\"\r\n                                                    v-model=\"inputedProduct.description\"\r\n                                                    @input=\"productDescription = filterTextInput($event.target.value)\"></textarea>\r\n                                                <p class=\"mt-1\">Maximum of 150 Characters</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <!-- Product Pricing Section -->\r\n                        <div class=\"accordion-card-one accordion\" id=\"accordionExample2\">\r\n                            <div class=\"accordion-item\">\r\n                                <div class=\"accordion-header\" id=\"headingTwo\">\r\n                                    <div class=\"accordion-button\" data-bs-toggle=\"collapse\"\r\n                                        data-bs-target=\"#collapseTwo\" aria-controls=\"collapseTwo\">\r\n                                        <div class=\"text-editor add-list\">\r\n                                            <div class=\"addproduct-icon list icon\">\r\n                                                <h5>\r\n                                                    <i data-feather=\"life-buoy\" class=\"add-info\"></i><span>Product\r\n                                                        Pricing</span>\r\n                                                </h5>\r\n                                                <a href=\"javascript:void(0);\"><i data-feather=\"chevron-down\"\r\n                                                        class=\"chevron-down-add\"></i></a>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div id=\"collapseTwo\" class=\"accordion-collapse collapse show\"\r\n                                    aria-labelledby=\"headingTwo\" data-bs-parent=\"#accordionExample2\">\r\n                                    <div class=\"accordion-body\">\r\n                                        <div class=\"row\">\r\n                                            <div class=\"col-lg-4 col-sm-6 col-12\">\r\n                                                <div class=\"mb-3 add-product\">\r\n                                                    <label class=\"form-label\">Price</label>\r\n                                                    <input type=\"number\" class=\"form-control\"\r\n                                                        v-model=\"inputedProduct.price\" required placeholder=\"0.00\" />\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"col-lg-4 col-sm-6 col-12\">\r\n                                                <div class=\"mb-3 add-product\">\r\n                                                    <label class=\"form-label\">Cost</label>\r\n                                                    <input type=\"number\" class=\"form-control\"\r\n                                                        v-model=\"inputedProduct.cost\" required placeholder=\"0.00\" />\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"col-lg-4 col-sm-6 col-12\">\r\n                                                <div class=\"mb-3 add-product\">\r\n                                                    <label class=\"form-label\">Tax Type</label>\r\n                                                    <select class=\"form-control\" v-model=\"inputedProduct.taxType\">\r\n                                                        <option selected value=\"vatable\">Vatable Sales</option>\r\n                                                        <option value=\"non-vatable\">None Vatable Sales</option>\r\n                                                    </select>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"collapseThree\" class=\"accordion-collapse collapse show\" aria-labelledby=\"headingThree\"\r\n                        data-bs-parent=\"#accordionExample3\">\r\n                        <div class=\"accordion-body\">\r\n                            <div class=\"text-editor add-list add\">\r\n                                <div class=\"col-lg-12\">\r\n    <div class=\"add-choosen\">\r\n        <div class=\"input-blocks\">\r\n            <div class=\"image-upload\">\r\n                <input type=\"file\" @change=\"onFileChange\" />\r\n                <div class=\"image-uploads\" v-if=\"!inputedProduct.image.url && !inputedProduct.url\">\r\n                    <i data-feather=\"plus-circle\"></i>\r\n                    <h4>Add Images</h4>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"phone-img\" v-if=\"inputedProduct.image.url || inputedProduct.url\">\r\n            <img :src=\"`${imageURL}${inputedProduct.image}` || `${imageURL}${inputedProduct.url}`\" alt=\"Product Image\" />\r\n            <a href=\"javascript:void(0);\" @click=\"removeImage\">\r\n                <i data-feather=\"x\" class=\"x-square-add remove-product\"></i>\r\n            </a>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <!-- Save Buttons -->\r\n\r\n                </div>\r\n                <div class=\"col-lg-12\">\r\n                    <div class=\"btn-addproduct mb-4\">\r\n                        <button type=\"button\" class=\"btn btn-cancel me-2\">Cancel</button>\r\n                        <button type=\"submit\" class=\"btn btn-submit\">Save Product</button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class=\"modal fade\" id=\"add-units\">\r\n        <div class=\"modal-dialog modal-dialog-centered stock-adjust-modal\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"page-wrapper-new p-0\">\r\n                    <div class=\"content\">\r\n                        <div class=\"modal-header border-0 custom-modal-header\">\r\n                            <div class=\"page-title\">\r\n                                <h4>Add Variation Attribute</h4>\r\n                            </div>\r\n                            <button type=\"button\" class=\"close\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\r\n                                <span aria-hidden=\"true\">&times;</span>\r\n                            </button>\r\n                        </div>\r\n                        <div class=\"modal-body custom-modal-body\">\r\n                            <div class=\"row\">\r\n                                <div class=\"col-lg-12\">\r\n                                    <div class=\"input-blocks\">\r\n                                        <label>Attribute Name</label>\r\n                                        <input type=\"text\" class=\"form-control\" v-model=\"inputedProduct.variant\" />\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"col-lg-12\">\r\n                                    <div class=\"input-blocks\">\r\n                                        <label>Add Value</label>\r\n                                        <input type=\"text\" class=\"form-control\" />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"row\">\r\n                                <div class=\"col-lg-6\">\r\n\r\n                                </div>\r\n                                <div class=\"col-lg-6\">\r\n                                    <div class=\"modal-footer-btn popup\">\r\n                                        <a href=\"javascript:void(0);\" class=\"btn btn-cancel me-2\"\r\n                                            data-bs-dismiss=\"modal\">Cancel</a>\r\n                                        <a href=\"javascript:void(0);\" class=\"btn btn-submit\"\r\n                                            data-bs-dismiss=\"modal\">Create Attribute</a>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"modal fade\" id=\"add-units-category\">\r\n        <div class=\"modal-dialog modal-dialog-centered custom-modal-two\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"page-wrapper-new p-0\">\r\n                    <div class=\"content\">\r\n                        <div class=\"modal-header border-0 custom-modal-header\">\r\n                            <div class=\"page-title\">\r\n                                <h4>Add New Category</h4>\r\n                            </div>\r\n                            <button type=\"button\" class=\"close\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\r\n                                <span aria-hidden=\"true\">&times;</span>\r\n                            </button>\r\n                        </div>\r\n                        <div class=\"modal-body custom-modal-body\">\r\n                            <div class=\"mb-3\">\r\n                                <label class=\"form-label\">Name</label>\r\n                                <input type=\"text\" class=\"form-control\" />\r\n                            </div>\r\n                            <div class=\"modal-footer-btn\">\r\n                                <a href=\"javascript:void(0);\" class=\"btn btn-cancel me-2\"\r\n                                    data-bs-dismiss=\"modal\">Cancel</a>\r\n                                <a href=\"add-product.html\" class=\"btn btn-submit\">Submit</a>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"modal fade\" id=\"add-units-brand\">\r\n        <div class=\"modal-dialog modal-dialog-centered custom-modal-two\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"page-wrapper-new p-0\">\r\n                    <div class=\"content\">\r\n                        <div class=\"modal-header border-0 custom-modal-header\">\r\n                            <div class=\"page-title\">\r\n                                <h4>Add New Brand</h4>\r\n                            </div>\r\n                            <button type=\"button\" class=\"close\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\r\n                                <span aria-hidden=\"true\">&times;</span>\r\n                            </button>\r\n                        </div>\r\n                        <div class=\"modal-body custom-modal-body\">\r\n                            <div class=\"mb-3\">\r\n                                <label class=\"form-label\">Brand</label>\r\n                                <input type=\"text\" class=\"form-control\" />\r\n                            </div>\r\n                            <div class=\"modal-footer-btn\">\r\n                                <a href=\"javascript:void(0);\" class=\"btn btn-cancel me-2\"\r\n                                    data-bs-dismiss=\"modal\">Cancel</a>\r\n                                <a href=\"add-product.html\" class=\"btn btn-submit\">Submit</a>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"modal fade\" id=\"add-unit\">\r\n        <div class=\"modal-dialog modal-dialog-centered custom-modal-two\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"page-wrapper-new p-0\">\r\n                    <div class=\"content\">\r\n                        <div class=\"modal-header border-0 custom-modal-header\">\r\n                            <div class=\"page-title\">\r\n                                <h4>Add Unit</h4>\r\n                            </div>\r\n                            <button type=\"button\" class=\"close\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\r\n                                <span aria-hidden=\"true\">&times;</span>\r\n                            </button>\r\n                        </div>\r\n                        <div class=\"modal-body custom-modal-body\">\r\n                            <div class=\"mb-3\">\r\n                                <label class=\"form-label\">Unit</label>\r\n                                <input type=\"text\" class=\"form-control\" />\r\n                            </div>\r\n                            <div class=\"modal-footer-btn\">\r\n                                <a href=\"javascript:void(0);\" class=\"btn btn-cancel me-2\"\r\n                                    data-bs-dismiss=\"modal\">Cancel</a>\r\n                                <a href=\"add-product.html\" class=\"btn btn-submit\">Submit</a>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onBeforeUnmount, nextTick, watch } from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nimport axios from 'axios';\r\nimport 'select2';\r\nimport feather from 'feather-icons';\r\n\r\nimport Navbar from '/src/components/Admin/Navbar.vue';\r\nimport Barcode from './Barcode.vue';\r\nimport $ from 'jquery';\r\n\r\nexport default {\r\n    components: {\r\n  \r\n        Navbar,\r\n        Barcode\r\n    },\r\n    setup() {\r\n        const apiURL = process.env.VUE_APP_URL;\r\n        const imageURL = process.env.VUE_APP_IMAGE_URL;\r\n        const inputedProduct = ref({\r\n            sku: '',\r\n            name: '',\r\n            description: '',\r\n            price: 0,\r\n            cost: 0,\r\n            category: '',\r\n            subCategory: '',\r\n            unit: '',\r\n            brand: '',\r\n            variant: '',\r\n            discount: 0,\r\n            discountType: '',\r\n            manufacturedDate: '',\r\n            expiryDate: '',\r\n            status: '',\r\n            image: {file: null , url: null},\r\n            url:'',\r\n        });\r\n        const skuError = ref(null);\r\n        const route = useRoute();\r\n        const product = ref({});\r\n        const barcodeRef = ref(null);\r\n        const curreSKU = ref(null);\r\n        const categories = ref(null);\r\n         const  units = ref(null);\r\n        const  brands = ref(null);\r\n\r\n        const getSelection = async () => {\r\n            try {\r\n                const categoryResponse = await axios.get(`${apiURL}/get_category_list`);\r\n                const unitResponse = await axios.get(`${apiURL}/get_units_list`);\r\n                const brandResponse = await axios.get(`${apiURL}/brands_list`);\r\n\r\n                if (categoryResponse.data.success) {\r\n                    categories.value = categoryResponse.data.categories;\r\n                } else {\r\n                    Swal.fire('Error', categoryResponse.data.message, 'error');\r\n                }\r\n                if (unitResponse.data.success) {\r\n                    units.value = unitResponse.data.unitList;\r\n                } else {\r\n                    Swal.fire('Error', unitResponse.data.message, 'error');\r\n                }\r\n                if (brandResponse.data.success) {\r\n                    brands.value = brandResponse.data.brandList;\r\n                } else {\r\n                    Swal.fire('Error', brandResponse.data.message, 'error');\r\n                }\r\n            } catch (error) {\r\n                Swal.fire('Error', 'Failed to fetch selection data', 'error');\r\n            }\r\n        };\r\n\r\n\r\nconst triggerDownloadBarcode = () => {\r\n  if (barcodeRef.value) {\r\n    barcodeRef.value.downloadBarcode(); // Access the method on the Barcode component\r\n  }\r\n};\r\nconst getProductDetails = async () => {\r\n            const productId = route.params.id; // Use 'id' to match route param\r\n            try {\r\n                const response = await axios.get(`${apiURL}/get_product/${productId}`);\r\n                product.value = response.data.product;\r\n                curreSKU.value = response.data.product.sku; // Store current SKU for comparison\r\n                skuError.value = '';\r\n                inputedProduct.value.url = `${imgUrl}`\r\n            } catch (error) {\r\n                console.error('Error fetching product details:', error);\r\n            }\r\n        };\r\n\r\n        watch(product, (newProduct) => {\r\n    if (newProduct) {\r\n        inputedProduct.value = {\r\n            ...newProduct,\r\n            image: {\r\n                file: null, // No file since itâ€™s from the server\r\n                url: newProduct.imageUrl || null // Map `imageUrl` to `url`\r\n            },\r\n            url: newProduct.imageUrl || null // Maintain direct URL reference\r\n        };\r\n    }\r\n});\r\n\r\n        const select = ref('.select');\r\n\r\n        onMounted(async () => {\r\n            try {\r\n                await getProductDetails();\r\n                await $(select.value).select2();\r\n                await feather.replace();\r\n            } catch (error) {\r\n                console.log(error);\r\n            }\r\n        });\r\n\r\n        onBeforeUnmount(() => {\r\n            $(select.value).select2('destroy');\r\n        });\r\n\r\n        const toggleStatus = (event) => {\r\n            inputedProduct.value.status = event.target.checked ? 'active' : 'inactive';\r\n        };\r\n\r\n        const autoGenerateSKU = () => {\r\n            inputedProduct.value.sku = generateEAN13();\r\n        };\r\n\r\n        const generateEAN13 = () => {\r\n            let digits = '4';\r\n            for (let i = 0; i < 11; i++) {\r\n                digits += Math.floor(Math.random() * 10).toString();\r\n            }\r\n\r\n            let sumOdd = 0;\r\n            let sumEven = 0;\r\n\r\n            for (let i = 0; i < 12; i++) {\r\n                const digit = parseInt(digits[i], 10);\r\n                if (i % 2 === 0) {\r\n                    sumOdd += digit;\r\n                } else {\r\n                    sumEven += digit;\r\n                }\r\n            }\r\n\r\n            const totalSum = sumOdd + (sumEven * 3);\r\n            const checksum = (10 - (totalSum % 10)) % 10;\r\n\r\n            return digits + checksum;\r\n        };\r\n\r\n        watch(() => inputedProduct.value.sku, async (newSku) => {\r\n    if (newSku.length === 13) {\r\n        try {\r\n            const response = await axios.get(`${this.apiURL}/check_sku/${newSku}`);\r\n            console.log(response.data.exists);\r\n\r\n            if (response.data.exists) {\r\n                if (newSku !== curreSKU.value) {  // Compare with the previous SKU\r\n                    \r\n                    skuError.value = 'SKU already exists';  // Set error message\r\n                    inputedProduct.value.sku = '';\r\n                }\r\n            } else {\r\n                skuError.value = ''; // Clear any existing error if SKU is uniqueF\r\n            }\r\n        } catch (error) {\r\n            console.error('Error checking SKU:', error);\r\n            if (error.response) {\r\n                skuError.value = `${error.response.data.message}`;  // Backend error message\r\n            } \r\n        }\r\n    } \r\n});\r\n\r\nconst editProduct = async () => {\r\n    try {\r\n        const formData = new FormData();\r\n\r\n        // Append all fields except the image\r\n        Object.entries(inputedProduct.value).forEach(([key, value]) => {\r\n            if (key !== 'image') {\r\n                formData.append(key, value || '');\r\n            }\r\n        });\r\n\r\n        // Append the image file if uploaded\r\n        if (inputedProduct.value.image.file) {\r\n            formData.append('image', inputedProduct.value.image.file);\r\n        } else if (!inputedProduct.value.url) {\r\n            // Add a flag to remove the image if it was deleted\r\n            formData.append('removeImage', true);\r\n        }\r\n\r\n        const productId = route.params.id;\r\n        const response = await axios.patch(`${apiURL}/edit_products/${productId}`, formData, {\r\n            headers: { 'Content-Type': 'multipart/form-data' },\r\n        });\r\n\r\n        if (response.data.success) {\r\n            Swal.fire('Success', 'Product updated successfully!', 'success');\r\n            await getProductDetails(); // Refresh product details\r\n        } else {\r\n            Swal.fire('Error', response.data.message || 'Failed to update product', 'error');\r\n        }\r\n    } catch (error) {\r\n        console.error('Error updating product:', error);\r\n        Swal.fire('Error', 'An error occurred while updating the product', 'error');\r\n    }\r\n};\r\n\r\nconst onFileChange = (event) => {\r\n    const file = event.target.files[0];\r\n    if (file) {\r\n        inputedProduct.value.image = {\r\n            file: file,\r\n            url: URL.createObjectURL(file) // Create a local preview URL\r\n        };\r\n        inputedProduct.value.url = null; // Clear the server URL if a new image is uploaded\r\n    }\r\n};\r\n\r\n\r\nconst removeImage = () => {\r\n    // Release uploaded image URL\r\n    if (inputedProduct.value.image.url) {\r\n        URL.revokeObjectURL(inputedProduct.value.image.url);\r\n    }\r\n\r\n    // Clear image properties\r\n    inputedProduct.value.image = { file: null, url: null };\r\n    inputedProduct.value.url = null; // Clear server-provided image reference\r\n};\r\n\r\n        return {\r\n            inputedProduct,\r\n            select,\r\n            editProduct,\r\n            autoGenerateSKU,\r\n            toggleStatus,\r\n            onFileChange,\r\n            removeImage,\r\n            triggerDownloadBarcode,\r\n            skuError,\r\n            curreSKU,\r\n            imageURL,\r\n            apiURL,\r\n            getSelection,\r\n            categories,\r\n            units,\r\n            brands,\r\n        };\r\n    },\r\n    methods: {\r\n        filterTextInput(value) {\r\n            return value.replace(/\\D/g, '');\r\n        },\r\n        filterNumInput(value) {\r\n            return value.replace(/[^0-9.]/g, '');\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n\r\n\r\n<style scoped>\r\n.is-invalid {\r\n    border-color: red;\r\n}\r\n\r\n.text-danger {\r\n    color: red;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}